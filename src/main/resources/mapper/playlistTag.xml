<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.PlaylistTagMapper">

	
	
	
	
	<!-- 
	 SELECT * 
		FROM playlist_tag
		JOIN tag USING (tag_code)
        WHERE pl_code = 3
        AND tag_name LIKE '%El%'
	<select id="allPlaylist" resultMap="playlistMap" parameterType="SearchDTO">
		SELECT * FROM playlist
		JOIN user USING (user_email)
		WHERE pl_public_yn = 'Y'
		<if test="search != null">
			AND pl_title LIKE CONCAT('%', #{search}, '%')
		</if>
	</select> -->

	<!-- 플리 이름검색, 태그검색 -->
	<!-- <select id="searchPlaylist" resultMap="listTagMap" parameterType="SearchDTO">
		SELECT *
		FROM playlist_tag
		RIGHT JOIN playlist USING (pl_code)
		LEFT JOIN user USING (user_email)
		LEFT JOIN tag USING (tag_code)
		WHERE pl_public_yn = 'Y'
		<choose>
			<when test="select == 'title'">
				AND pl_title LIKE CONCAT('%', #{search}, '%')
			</when>
			<when test="select == 'tag'">
				AND tag_name LIKE CONCAT('%', #{search}, '%')
			</when>
		</choose>
	</select> -->
	
	<!-- 태그를 DB에 삽입 -->
    <insert id="insertTag" parameterType="com.master.vibe.model.vo.Tag">
        INSERT INTO tag(tag_name) VALUES (#{tagName})
    </insert>

    <!-- 태그 이름으로 태그 조회 -->
    <select id="selectTagByName" parameterType="String" resultType="com.master.vibe.model.vo.Tag">
        SELECT * FROM tag WHERE tag_name = #{tagName}
    </select>

    <!-- 플레이리스트 태그를 DB에 삽입 -->
    <insert id="insertPlaylistTag">
        INSERT INTO playlist_tag(pl_code, tag_code) VALUES (#{plCode}, #{tagCode})
    </insert>
	
	<select id="findTagsByPlaylistCode" resultType="String" parameterType="int">
	    SELECT tag_name 
	    FROM tag
	    	JOIN playlist_tag USING (tag_code)
	    WHERE pl_code = #{plCode}
	</select>
	
	
</mapper>
