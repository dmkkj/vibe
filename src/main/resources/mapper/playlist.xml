<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.PlaylistMapper">
	<!-- 
	<insert id="addPlaylist" parameterType="Playlist">	
		INSERT INTO playlist (pl_title, pl_img, pl_date, pl_public_yn, user_email)
		VALUES (#{plTitle}, #{plImg}, #{plDate}, #{plPublicYn}, #{userEmail})
	</insert>
	-->
		
	 <resultMap id="playlistMap" type="Playlist">
        <id column="pl_code" property="plCode" />
        <result column="pl_title" property="plTitle" />
        <result column="pl_img" property="plImg" />
        <result column="pl_date" property="plDate" />
        <result column="pl_public_yn" property="plPublicYn" />
   	<association property="user" javaType="User">
  	 	<id column="user_email" property="userEmail"/>
			<result column="user_password" property="userPassword"/>
			<result column="user_nickname" property="userNickname"/>
	</association>
    </resultMap>
	
	<select id="allPlaylist" resultMap="playlistMap">
		SELECT * FROM playlist
		JOIN user USING (user_email)
	</select>
	
	<!-- user 탈퇴 시 playlist 정보 넘기기 -->
	<update id="movePlaylist" parameterType="String">
		UPDATE playlist
		SET user_email = 'playlist@vibemaster.com'
		WHERE user_email = #{userEmail}
	</update>

    <insert id="insertPlaylist" parameterType="Playlist">
        INSERT INTO playlist(pl_title, user_email)
		VALUES (#{plTitle}, #{userEmail})
    </insert>
</mapper>
